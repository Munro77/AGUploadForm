@{
    Layout = null;
}

<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>jQuery File Upload Example</title>
</head>
<body>
    
    
        <input id="fileupload" type="file" name="files[]" multiple>
        
        <environment names="Development">
            <script src="~/lib/jquery/dist/jquery.js"></script>
            <script src="~/lib/blueimp-file-upload/js/vendor/jquery.ui.widget.js"></script>
            <script src="~/lib/blueimp-file-upload/js/jquery.iframe-transport.js"></script>
            <script src="~/lib/blueimp-file-upload/js/jquery.fileupload.js"></script>
            <script src="~/js/site.js" asp-append-version="true"></script>
        </environment>
        <environment names="Staging,Production">
            <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-2.2.0.min.js"
                    asp-fallback-src="~/lib/jquery/dist/jquery.min.js"
                    asp-fallback-test="window.jQuery">
            </script>
            <script src="~/lib/blueimp-file-upload/js/vendor/jquery.ui.widget.js"></script>
            <script src="~/lib/blueimp-file-upload/js/jquery.iframe-transport.js"></script>
            <script src="~/lib/blueimp-file-upload/js/jquery.fileupload.js"></script>
            <script src="~/js/site.min.js" asp-append-version="true"></script>
        </environment>

        <script>

            // Name of a web application (usually in full IIS mode). Can be found in Properties/Web/Server/Project-Url. Example: http://localhost/Demo (Name of web application is "Demo")
            var web_app = '/';

            // We use the upload handler integrated into Backload:
            // In this example we set an objectContect (id) in the url query (or as form parameter). You can use a user id as 
            // objectContext give users only access to their own uploads. ObjectContext can also be set server side (See Custom Data Provider Demo, 2.2+).
            var url = web_app + 'Backload/FileHandler?objectContext=abc';
            //var url = web_app + 'Backload/FileHandler';

            // Initialize the jQuery File Upload widget:
            var up = $('#fileupload');
            $('#fileupload').fileupload({
                url: url,
                acceptFileTypes: /(jpg)|(jpeg)|(png)|(gif)|(tif)|(pdf)$/i,              // Allowed file types
                
                done: function (e, data) {
                    $.each(data.result.files, function (index, file) {
                        
                        $('<p/>').text(file.name).appendTo(document.body);
                    });
                }

            });

            //Show all the files on initial load
            $.ajax({
                url: url,
                dataType: 'json'
            })
            .done(function (response) {
                $.each(response.files, function (index, file) {
                    $('<p/>').text(file.name).appendTo(document.body);
                });
            });

        </script>
</body>
</html>